# React 高频问题 & 解答

## 1. 什么是 CSR（客户端渲染），SSR（服务端渲染），isomorphic/universal（同构）

- **后端渲染**：服务器直接生成 HTML 文档并返回给浏览器，但页面交互能力有限。适用于任何后端语言：PHP、Java、Python、GO 等。
- **客户端渲染**：页面初始加载的 HTML 文档中无内容，需要下载执行 JS 文件，由浏览器动态生成页面，并通过 JS 进行页面交互事件与状态管理。
- **同构：isomorphic/universal**：基于 react、vue 框架，客户端渲染和服务器端渲染的结合，在服务器端执行一次，用于实现服务器端渲染（首屏直出），在客户端再执行一次，用于接管页面交互，核心解决 SEO 和首屏渲染慢的问题

### CSR 的问题

#### 1.客户端渲染的 TTFP（Time To First Page）时间比较长，一般起码需要 3 个 HTTP 请求周期

加载 HTML 文档 -> 加载 JS 文件 -> API 请求数据 -> 根据数据渲染页面
也就是初始化页面会出现白屏，性能上通过 Node 直出, 将传统的三次串行 http 请求简化成一次 http 请求，降低首屏渲染时间

#### 2.单页应用的 SEO 能力几乎为零

SPA 首次加载的 HTML 文档没有内容，而目前大多数搜索引擎主要识别的内容还是 HTML，对 JavaScript 文件内容的识别都还比较弱，所以如果公司对 SEO 有需求（或者将来需要），那么 SPA 就不太适合了

### CSR 和 SSR 有几个共同点

- 都需要下载 React 的
- 都需要经历虚拟 DOM 构建过程
- 都需要（给页面元素）绑定事件来增强页面的可交互性

不过对于使用 SSR 方式渲染出的 HTML 页面来说，用户是可以在这些操作（指的是下载 React、构建虚拟 DOM、绑定事件）完成之前就能看到页面。

再反观使用 CSR 方式渲染出的 HTML 页面，你必须等到上面的这些操作（指的是下载 React、构建虚拟 DOM、绑定事件）都完成，virtual-dom 转换成（浏览器）页面上的真实 dom 之后，用户才能看到页面。

### SSR 的缺点？

#### 理论上，SSR（包括传统的服务端渲染）最大的瓶颈就是服务端的性能

> 如果用户规模大，SPA 本身就是一个大型分布式系统，充分利用用户的设备去运行 JS 的运算，SSR 则是把这些工作包揽到自己的服务器上。所以对于需要大量计算（图表特别多）而且用户量巨大的页面，并不太适合，但 SSR 非常适合于大部分的内容展示页面

#### 项目复杂度增加，需要前端团队有较高的技术素养

> 为了同构要处处兼容 Node.js 不同的执行环境，不能有浏览器相关的原生代码在服务端执行，前端代码使用的 window 在 node 环境是不存在的，所以要 mock window，其中最重要的是 cookie，userAgent，location
